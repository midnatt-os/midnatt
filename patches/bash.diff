diff --git a/externs.h b/externs.h
index 3d7716c..8fb66a8 100644
--- a/externs.h
+++ b/externs.h
@@ -290,7 +290,7 @@ extern int getdtablesize PARAMS((void));
 #endif /* !HAVE_GETDTABLESIZE */
 
 #if !defined (HAVE_GETHOSTNAME)
-extern int gethostname PARAMS((char *, int));
+extern int gethostname PARAMS((char *, size_t));
 #endif /* !HAVE_GETHOSTNAME */
 
 extern int getmaxgroups PARAMS((void));
diff --git a/subst.c b/subst.c
index 9ccbf33..909bac9 100644
--- a/subst.c
+++ b/subst.c
@@ -32,6 +32,7 @@
 #endif
 #include <signal.h>
 #include <errno.h>
+#include <limits.h>
 
 #if defined (HAVE_UNISTD_H)
 #  include <unistd.h>
diff --git a/support/config.sub b/support/config.sub
index c874b7a..b46ab6f 100755
--- a/support/config.sub
+++ b/support/config.sub
@@ -1720,7 +1720,7 @@ case $os in
 	     | skyos* | haiku* | rdos* | toppers* | drops* | es* \
 	     | onefs* | tirtos* | phoenix* | fuchsia* | redox* | bme* \
 	     | midnightbsd* | amdhsa* | unleashed* | emscripten* | wasi* \
-	     | nsk* | powerunix* | genode* | zvmoe* | qnx* | emx*)
+	     | nsk* | powerunix* | genode* | zvmoe* | qnx* | emx* | midnatt*)
 		;;
 	# This one is extra strict with allowed versions
 	sco3.2v2 | sco3.2v[4-9]* | sco5v6*)
diff --git a/support/shobj-conf b/support/shobj-conf
index 5a3f977..1635ae1 100755
--- a/support/shobj-conf
+++ b/support/shobj-conf
@@ -79,6 +79,10 @@ nsk-cc-tandem|nsk-c99-tandem)
 	SHOBJ_LDFLAGS='-shared -bglobalized -unres_symbols ignore'
 	;;
 
+midnatt*-*gcc*)
+	SHOBJ_CFLAGS=-fpic
+	;;
+
 sunos4*-*gcc*)
 	SHOBJ_CFLAGS=-fpic
 	SHOBJ_LD=/usr/bin/ld
